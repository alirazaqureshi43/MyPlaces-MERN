import{j as e,r,A as M,a as C,b as D}from"./index-BBY7Hu33.js";import{u as g,E as p,M as f,B as n}from"./http-hook-BaJhmCFA.js";import{C as E}from"./Card-QDGsE82P.js";const N=()=>e.jsx("div",{className:"map",children:"The Map!"}),v=s=>{const t=r.useContext(M),{isLoading:l,error:m,sendRequest:c,clearError:i}=g(),[o,d]=r.useState(!1),[h,a]=r.useState(!1),x=()=>d(!0),u=()=>d(!1),P=()=>a(!0),j=()=>a(!1),_=async()=>{a(!1);try{await c(`http://localhost:5000/api/places/${s.id}`,"DELETE",null,{Authorization:`Bearer ${t.token}`}),s.onDelete(s.id)}catch{}};return e.jsxs(e.Fragment,{children:[e.jsx(p,{error:m,onClear:i}),e.jsx(f,{show:o,onCancel:u,header:s.address,contentClass:"place-item__modal-content",footerClass:"place-item__modal-actions",footer:e.jsx(n,{onClick:u,children:"Close"}),children:e.jsx("div",{className:"map-container",children:e.jsx(N,{})})}),e.jsx(f,{header:"Are you sure?",footerClass:"place-item__modal-actions",show:h,onCancel:j,footer:e.jsxs(e.Fragment,{children:[e.jsx(n,{inverse:!0,onClick:j,children:"Cancel"}),e.jsx(n,{danger:!0,onClick:_,children:"Delete"})]}),children:e.jsx("p",{children:"Do you want to proceed and delete the place ? Please note that it can not be undone thereafter."})}),e.jsx("li",{className:"place-item",children:e.jsxs(E,{className:"place-item__content",children:[l&&e.jsx(C,{asOverlay:!0}),e.jsx("div",{className:"place-item__image",children:e.jsx("img",{src:`http://localhost:5000/${s.image}`,alt:s.title})}),e.jsxs("div",{className:"place-item__info",children:[e.jsx("h2",{children:s.title}),e.jsx("h3",{children:s.address}),e.jsx("p",{children:s.description})]}),e.jsxs("div",{className:"place-item__actions",children:[e.jsx(n,{inverse:!0,onClick:x,children:"VIEW ON MAP"}),t.isLoggedIn&&t.userId===s.creatorId&&e.jsxs(e.Fragment,{children:[e.jsx(n,{to:`/places/${s.id}`,children:"EDIT"}),e.jsx(n,{danger:!0,onClick:P,children:"DELETE"})]})]})]})})]})},w=s=>s.items.length===0?e.jsx("div",{className:"place-list center",children:e.jsxs(E,{children:[e.jsx("h2",{children:"No places found. Maybe create one?"}),e.jsx(n,{to:"/places/new",children:"Share Place"})]})}):e.jsx("ul",{className:"place-list",children:s.items.map(t=>e.jsx(v,{id:t.id,image:t.image,title:t.title,description:t.description,address:t.address,creatorId:t.creator,coordinates:t.location,onDelete:s.onDeletePlace},t.id))}),L=()=>{const{isLoading:s,error:t,sendRequest:l,clearError:m}=g(),c=D().userId,[i,o]=r.useState([]);r.useEffect(()=>{(async()=>{try{const a=await l(`http://localhost:5000/api/places/user/${c}`);o(a.places)}catch{}})()},[l,c]);const d=h=>{o(a=>a.filter(x=>x.id!==h))};return e.jsxs(e.Fragment,{children:[e.jsx(p,{error:t,onClear:m}),s&&e.jsx("div",{className:"center",children:e.jsx(C,{asOverlay:!0})}),!s&&i&&e.jsx(w,{items:i,onDeletePlace:d})]})};export{L as default};
