import{u as j,r as d,A as w,j as e,a as L}from"./index-BBY7Hu33.js";import{C as y}from"./Card-QDGsE82P.js";import{u as S,I as n,V as T,b as V,a as A}from"./form-hook-DJIKuCCT.js";import{u as E,E as N,B as m}from"./http-hook-BaJhmCFA.js";import{I as b}from"./ImageUpload-B02z8MMy.js";const M=()=>{const o=j(),l=d.useContext(w),[i,c]=d.useState(!0),{isLoading:x,error:h,sendRequest:u,clearError:v}=E(),[a,r,p]=S({email:{value:"",isValid:!1},password:{value:"",isValid:!1}}),I=async f=>{if(f.preventDefault(),i){const s={email:a.inputs.email.value,password:a.inputs.password.value};try{const t=await u("http://localhost:5000/api/users/login","POST",JSON.stringify(s),{"Content-Type":"application/json"});l.login(t.userId,t.token),o(`/${t.userId}/places`)}catch{}}else try{const s=new FormData;s.append("name",a.inputs.name.value),s.append("email",a.inputs.email.value),s.append("password",a.inputs.password.value),s.append("image",a.inputs.image.value);const t=await u("http://localhost:5000/api/users/signup","POST",s);l.login(t.userId),o(`/${t.userId}/places`)}catch{}},g=()=>{i?p({...a.inputs,name:{value:"",isValid:!1},image:{value:null,isValid:!1}},!1):p({...a.inputs,name:void 0,image:void 0},a.inputs.email.isValid&&a.inputs.password.isValid),c(!i)};return e.jsxs(e.Fragment,{children:[e.jsx(N,{error:h,onClear:v}),e.jsxs(y,{className:"authentication",children:[x&&e.jsx(L,{asOverlay:!0}),e.jsx("h2",{children:"Login Required"}),e.jsx("hr",{}),e.jsxs("form",{onSubmit:I,children:[!i&&e.jsxs(e.Fragment,{children:[e.jsx(n,{element:"input",id:"name",type:"text",label:"Name",validators:[T()],errorText:"Please enter a name",onInput:r}),e.jsx(b,{id:"image",center:!0,onInput:r,errorText:"Please provide an image"})]}),e.jsx(n,{element:"input",id:"email",type:"email",label:"E-Mail",validators:[V()],errorText:"Please enter a valid email",onInput:r}),e.jsx(n,{element:"input",id:"password",type:"password",label:"Password",validators:[A(5)],errorText:"Please enter a valid password, at least 5 characters",onInput:r}),e.jsx(m,{type:"submit",disabled:!a.isValid,children:i?"LOGIN":"SIGN UP"})]}),e.jsxs(m,{inverse:!0,onClick:g,children:["Switch to ",i?"SIGN UP":"LOGIN"]})]})]})};export{M as default};
