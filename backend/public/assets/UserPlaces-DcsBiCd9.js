import{j as e,r as n,A as P,a as f,b as _}from"./index-DAs0rZAi.js";import{u as C,E as g,M as p,B as r}from"./http-hook-iPg4NjC-.js";import{C as E}from"./Card-3b1735Y7.js";const M=()=>e.jsx("div",{className:"map",children:"The Map!"}),y=s=>{const a=n.useContext(P),{isLoading:c,error:m,sendRequest:l,clearError:i}=C(),[o,d]=n.useState(!1),[h,t]=n.useState(!1),u=()=>d(!0),x=()=>d(!1),v=()=>t(!0),j=()=>t(!1),w=async()=>{t(!1);try{await l(`https://my-place-backend-168epwqz4-alirazaqureshi43s-projects.vercel.app/api/places/${s.id}`,"DELETE",null,{Authorization:`Bearer ${a.token}`}),s.onDelete(s.id)}catch{}};return e.jsxs(e.Fragment,{children:[e.jsx(g,{error:m,onClear:i}),e.jsx(p,{show:o,onCancel:x,header:s.address,contentClass:"place-item__modal-content",footerClass:"place-item__modal-actions",footer:e.jsx(r,{onClick:x,children:"Close"}),children:e.jsx("div",{className:"map-container",children:e.jsx(M,{})})}),e.jsx(p,{header:"Are you sure?",footerClass:"place-item__modal-actions",show:h,onCancel:j,footer:e.jsxs(e.Fragment,{children:[e.jsx(r,{inverse:!0,onClick:j,children:"Cancel"}),e.jsx(r,{danger:!0,onClick:w,children:"Delete"})]}),children:e.jsx("p",{children:"Do you want to proceed and delete the place ? Please note that it can not be undone thereafter."})}),e.jsx("li",{className:"place-item",children:e.jsxs(E,{className:"place-item__content",children:[c&&e.jsx(f,{asOverlay:!0}),e.jsx("div",{className:"place-item__image",children:e.jsx("img",{src:`https://my-place-backend-168epwqz4-alirazaqureshi43s-projects.vercel.app/${s.image}`,alt:s.title})}),e.jsxs("div",{className:"place-item__info",children:[e.jsx("h2",{children:s.title}),e.jsx("h3",{children:s.address}),e.jsx("p",{children:s.description})]}),e.jsxs("div",{className:"place-item__actions",children:[e.jsx(r,{inverse:!0,onClick:u,children:"VIEW ON MAP"}),a.isLoggedIn&&a.userId===s.creatorId&&e.jsxs(e.Fragment,{children:[e.jsx(r,{to:`/places/${s.id}`,children:"EDIT"}),e.jsx(r,{danger:!0,onClick:v,children:"DELETE"})]})]})]})})]})},D=s=>s.items.length===0?e.jsx("div",{className:"place-list center",children:e.jsxs(E,{children:[e.jsx("h2",{children:"No places found. Maybe create one?"}),e.jsx(r,{to:"/places/new",children:"Share Place"})]})}):e.jsx("ul",{className:"place-list",children:s.items.map(a=>e.jsx(y,{id:a.id,image:a.image,title:a.title,description:a.description,address:a.address,creatorId:a.creator,coordinates:a.location,onDelete:s.onDeletePlace},a.id))}),$=()=>{const{isLoading:s,error:a,sendRequest:c,clearError:m}=C(),l=_().userId,[i,o]=n.useState([]);n.useEffect(()=>{(async()=>{try{const t=await c(`https://my-place-backend-168epwqz4-alirazaqureshi43s-projects.vercel.app/api/places/user/${l}`);o(t.places)}catch{}})()},[c,l]);const d=h=>{o(t=>t.filter(u=>u.id!==h))};return e.jsxs(e.Fragment,{children:[e.jsx(g,{error:a,onClear:m}),s&&e.jsx("div",{className:"center",children:e.jsx(f,{asOverlay:!0})}),!s&&i&&e.jsx(D,{items:i,onDeletePlace:d})]})};export{$ as default};
