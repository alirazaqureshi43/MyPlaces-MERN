import{u as f,r as d,A as w,j as e,a as y}from"./index-DAs0rZAi.js";import{C as L}from"./Card-3b1735Y7.js";import{u as b,I as n,V as S,b as T,a as V}from"./form-hook-DEVisYxr.js";import{u as A,E,B as m}from"./http-hook-iPg4NjC-.js";import{I as N}from"./ImageUpload-CuN80og0.js";const q=()=>{const l=f(),o=d.useContext(w),[r,c]=d.useState(!0),{isLoading:v,error:x,sendRequest:p,clearError:h}=A(),[a,i,u]=b({email:{value:"",isValid:!1},password:{value:"",isValid:!1}}),I=async j=>{if(j.preventDefault(),r){const s={email:a.inputs.email.value,password:a.inputs.password.value};try{const t=await p("https://my-place-backend-168epwqz4-alirazaqureshi43s-projects.vercel.app/api/users/login","POST",JSON.stringify(s),{"Content-Type":"application/json"});o.login(t.userId,t.token),l(`/${t.userId}/places`)}catch{}}else try{const s=new FormData;s.append("name",a.inputs.name.value),s.append("email",a.inputs.email.value),s.append("password",a.inputs.password.value),s.append("image",a.inputs.image.value);const t=await p("https://my-place-backend-168epwqz4-alirazaqureshi43s-projects.vercel.app/api/users/signup","POST",s);o.login(t.userId),l(`/${t.userId}/places`)}catch{}},g=()=>{r?u({...a.inputs,name:{value:"",isValid:!1},image:{value:null,isValid:!1}},!1):u({...a.inputs,name:void 0,image:void 0},a.inputs.email.isValid&&a.inputs.password.isValid),c(!r)};return e.jsxs(e.Fragment,{children:[e.jsx(E,{error:x,onClear:h}),e.jsxs(L,{className:"authentication",children:[v&&e.jsx(y,{asOverlay:!0}),e.jsx("h2",{children:"Login Required"}),e.jsx("hr",{}),e.jsxs("form",{onSubmit:I,children:[!r&&e.jsxs(e.Fragment,{children:[e.jsx(n,{element:"input",id:"name",type:"text",label:"Name",validators:[S()],errorText:"Please enter a name",onInput:i}),e.jsx(N,{id:"image",center:!0,onInput:i,errorText:"Please provide an image"})]}),e.jsx(n,{element:"input",id:"email",type:"email",label:"E-Mail",validators:[T()],errorText:"Please enter a valid email",onInput:i}),e.jsx(n,{element:"input",id:"password",type:"password",label:"Password",validators:[V(5)],errorText:"Please enter a valid password, at least 5 characters",onInput:i}),e.jsx(m,{type:"submit",disabled:!a.isValid,children:r?"LOGIN":"SIGN UP"})]}),e.jsxs(m,{inverse:!0,onClick:g,children:["Switch to ",r?"SIGN UP":"LOGIN"]})]})]})};export{q as default};
